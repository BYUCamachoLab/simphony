#TODO: write tests for simulation.py